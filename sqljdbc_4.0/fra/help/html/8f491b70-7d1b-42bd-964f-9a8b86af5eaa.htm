<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Utilisation d'une procédure stockée avec des paramètres d'entrée</title><meta name="Language" content="fr-fr" /><meta name="Microsoft.Help.Id" content="8f491b70-7d1b-42bd-964f-9a8b86af5eaa" /><meta name="Description" content="Une procédure stockée SQL Server que vous pouvez appeler est une procédure contenant un ou plusieurs paramètres IN que la procédure stockée peut utiliser pour transmettre des données dans la procédure stockée." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Utilisation d'une procédure stockée avec des paramètres d'entrée</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Une procédure stockée SQL Server que vous pouvez appeler est une procédure contenant un ou plusieurs paramètres IN que la procédure stockée peut utiliser pour transmettre des données dans la procédure stockée. Le Pilote JDBC Microsoft pour SQL Server intègre la classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>, que vous pouvez utiliser pour appeler ce type de procédure stockée et traiter les données qu'elle retourne. </p><p>Lorsque vous utilisez le pilote JDBC pour appeler une procédure stockée avec des paramètres IN, vous devez utiliser la séquence d'échappement SQL <span class="code"> call </span> conjointement avec la méthode <a href="265b024c-898a-4bd0-98b5-f06076717b9e.htm">prepareCall</a> de la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. La syntaxe de la séquence d'échappement <span class="code"> call </span> avec les paramètres IN est la suivante :</p><p><span class="code">{call procedure-name[([parameter][,[parameter]]...)]}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Pour plus d'informations sur les séquences d'échappement SQL, consultez <span sdata="link"><a href="00f9e25a-088e-4ac6-aa75-43eacace8f03.htm">Utilisation de séquences d'échappement SQL</a></span>.</p></div><p>Lorsque vous construisez la séquence d'échappement <span class="code"> call </span>, spécifiez les paramètres IN à l'aide du caractère ? (point d'interrogation). Ce caractère fait office d'espace réservé pour les valeurs de paramètre qui sont transmises à la procédure stockée. Pour spécifier une valeur pour un paramètre, vous pouvez utiliser l'une des méthodes de définition de la classe <b>SQLServerPreparedStatement</b>. La méthode de définition que vous pouvez utiliser est déterminée par le type de données du paramètre IN. </p><p>Lorsque vous transmettez une valeur à la méthode de définition, vous devez spécifier non seulement la valeur réelle qui sera utilisée dans le paramètre, mais également la position ordinale dans la procédure stockée. Par exemple, si votre procédure stockée contient un seul paramètre IN, sa valeur ordinale sera 1. Si la procédure stockée contient deux paramètres, la première valeur ordinale sera 1 et la deuxième sera 2.</p><p>Pour obtenir un exemple de la manière d'appeler une procédure stockée contenant un paramètre IN, utilisez la procédure stockée uspGetEmployeeManagers figurant dans l'exemple de base de données SQL Server 2005 AdventureWorks. Cette procédure stockée n'accepte qu'un seul paramètre d'entrée nommé EmployeeID, qui est une valeur entière, et retourne une liste récursive d'employés et de leurs directeurs basée sur la valeur EmployeeID spécifiée. Le code Java pour l'appel de cette procédure stockée est le suivant :</p><div class="sampleCode"><span codeLanguage="other"><pre>public static void executeSprocInParams(Connection con) {
   try {
      PreparedStatement pstmt = con.prepareStatement("{call dbo.uspGetEmployeeManagers(?)}");
      pstmt.setInt(1, 50);
      ResultSet rs = pstmt.executeQuery();

      while (rs.next()) {
         System.out.println("EMPLOYEE:");
         System.out.println(rs.getString("LastName") + ", " + rs.getString("FirstName"));
         System.out.println("MANAGER:");
         System.out.println(rs.getString("ManagerLastName") + ", " + rs.getString("ManagerFirstName"));
         System.out.println();
      }
      rs.close();
      pstmt.close();
   }

   catch (Exception e) {
      e.printStackTrace();
    }
}</pre></span></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Utilisation d'instructions avec des procédures stockées</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>