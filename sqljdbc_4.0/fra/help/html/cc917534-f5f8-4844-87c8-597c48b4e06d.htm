<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Travail sur des instructions et des jeux de résultats</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="performances des jeux de résultats" /><meta name="System.Keywords" content="performances des instructions" /><meta name="Microsoft.Help.Id" content="cc917534-f5f8-4844-87c8-597c48b4e06d" /><meta name="Description" content="Lorsque vous travaillez avec le Pilote JDBC Microsoft pour SQL Server et les objets Statement et ResultSet qui l'accompagnent, il existe plusieurs techniques que vous pouvez utiliser pour améliorer les performances et la fiabilité de vos applications." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Travail sur des instructions et des jeux de résultats</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Lorsque vous travaillez avec le Pilote JDBC Microsoft pour SQL Server et les objets <b>Statement</b> et <b>ResultSet</b> qui l'accompagnent, il existe plusieurs techniques que vous pouvez utiliser pour améliorer les performances et la fiabilité de vos applications. </p></div><h1 class="heading">Utilisez l'objet d'instruction approprié</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Lorsque vous utilisez l'un des objets <b>Statement</b> du pilote JDBC, par exemple l'objet <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>, <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> ou <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>, assurez-vous que vous utilisez l'objet approprié pour la tâche.</p><ul><li><p>Si vous ne disposez pas de paramètres OUT, vous n'avez pas à utiliser l'objet <b>SQLServerCallableStatement</b>. À la place, utilisez l'objet <b>SQLServerStatement</b> ou <b>SQLServerPreparedStatement</b>.</p></li><li><p>Si vous n'avez pas l'intention d'exécuter l'instruction plus d'une fois ou si vous ne disposez ni de paramètres IN ni de paramètres OUT, vous n'avez pas à utiliser l'objet <b>SQLServerCallableStatement</b> ou <b>SQLServerPreparedStatement</b>. À la place, utilisez l'objet <b>SQLServerStatement</b>.</p></li></ul></div><h1 class="heading">Utilisez l'accès simultané approprié aux objets ResultSet</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Ne demandez pas d'accès simultané pouvant être mis à jour lorsque vous créez des instructions produisant des jeux de résultats, à moins que vous n'ayez réellement l'intention de mettre à jour les résultats. Le modèle de curseur en avant uniquement et en lecture seule est le plus rapide pour lire les petits jeux de résultats.</p></div><h1 class="heading">Limitez la taille de vos jeux de résultats</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Envisagez d'utiliser la méthode <a href="cccc0667-589b-4655-8ea8-14ae8b2eb9dc.htm">setMaxRows</a> (ou la syntaxe SET ROWCOUNT ou SELECT TOP N SQL) pour limiter le nombre de lignes retournées par des jeux de résultats potentiellement volumineux. Si vous devez gérer des jeux de résultats volumineux, songez à utiliser une mise en mémoire tampon adaptative des réponses en définissant la propriété de chaîne de connexion responseBuffering=adaptive, qui est le mode par défaut. Cette approche permet à l'application de traiter des jeux de résultats volumineux sans nécessiter de curseurs côté serveur ; par ailleurs, elle réduit l'utilisation de la mémoire de l'application. Pour plus d'informations, consultez <span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">Utilisation de la mise en mémoire tampon adaptative</a></span>.</p></div><h1 class="heading">Utilisez la taille d'extraction appropriée</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Pour les curseurs côté serveur en lecture seule, il est nécessaire de choisir entre de nombreux allers-retours vers le serveur ou l'utilisation d'une grande quantité de mémoire dans le pilote. Pour les curseurs de serveurs pouvant être mis à jour, la taille d'extraction influence également la sensibilité des modifications au jeu de résultats et à l'accès simultané du serveur. Les mises à jour des lignes dans le tampon d'extraction actuel ne sont pas visibles jusqu'à ce qu'une méthode explicite <a href="048fe245-157f-4fd8-be75-ce54b83e02b3.htm">refreshRow</a> soit lancée ou que le curseur quitte le tampon d'extraction. Les performances des tampons d'extraction importants seront meilleures (moins de boucles de connexion avec le serveur) ; néanmoins, les tampons sont moins sensibles aux modifications et réduisent l'accès simultané au serveur si CONCUR_SS_SCROLL_LOCKS (1009) est utilisé. Pour une sensibilité maximale aux modifications, utilisez une taille d'extraction de 1. Cependant, notez que cela provoquera une boucle avec le serveur pour chaque ligne extraite.</p></div><h1 class="heading">Utilisez des flux pour des paramètres IN importants</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Utilisez des flux ou des BLOB et des CLOB matérialisés de manière incrémentielle pour traiter la mise à jour d'importantes valeurs de colonne ou l'envoi d'importants paramètres IN. Le pilote JDBC envoie ces éléments au serveur par plusieurs boucles de connexion, ce qui vous permet de définir et de mettre à jour des valeurs plus importantes que ce que la mémoire peut contenir.</p></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="e1592499-b87b-45ee-bab8-beaba8fde841.htm">Amélioration des performances et de la fiabilité avec le pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>