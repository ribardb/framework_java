<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Programmation à l'aide de SQLXML</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="mise en mémoire tampon adaptative" /><meta name="System.Keywords" content="programmation à l'aide de sqlxml" /><meta name="System.Keywords" content="sqlxml" /><meta name="System.Keywords" content="xml" /><meta name="Microsoft.Help.Id" content="4d2cc57c-7293-4d92-b8b1-525e2b35f591" /><meta name="Description" content="Cette section explique comment utiliser les méthodes de l'API du Pilote JDBC Microsoft pour SQL Server pour stocker et récupérer un document XML dans une base de données relationnelle à l'aide d'objets SQLXML." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Programmation à l'aide de SQLXML</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Cette section explique comment utiliser les méthodes de l'API du Pilote JDBC Microsoft pour SQL Server pour stocker et récupérer un document XML dans une base de données relationnelle à l'aide d'objets <span sdata="langKeyword" value="SQLXML"><span class="keyword">SQLXML</span></span>. </p><p>Cette section contient également des informations sur les types d'objets SQLXML ; par ailleurs, elle dresse une liste des recommandations et limitations importantes relatives à l'utilisation des objets SQLXML.</p></div><h1 class="heading">Lecture et écriture de données XML à l'aide d'objets SQLXML</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>La liste suivante explique comment utiliser les méthodes de l'API du Pilote JDBC Microsoft pour SQL Server pour lire et écrire des données XML à l'aide d'objets SQLXML :</p><ul><li><p>Pour créer un objet SQLXML, utilisez la méthode <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> de la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Notez que cette méthode crée un objet SQLXML sans aucune donnée. Pour ajouter des données <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> à un objet SQLXML, appelez l'une des méthodes suivantes spécifiées dans l'interface SQLXML : <b>setResult</b>, <b>setCharacterStream</b>, <b>setBinaryStream</b> ou <b>setString</b>.</p></li><li><p>Pour récupérer l'objet SQLXML proprement dit, utilisez les méthodes <b>getSQLXML</b> de la classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> ou de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>. </p></li><li><p>Pour récupérer les données <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> d'un objet SQLXML, utilisez l'une des méthodes suivantes spécifiées dans l'interface SQLXML : <b>getSource</b>, <b>getCharacterStream</b>, <b>getBinaryStream</b> ou <b>getString</b>. </p></li><li><p>Pour mettre à jour les données <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> dans un objet SQLXML, utilisez la méthode <a href="abe8ff37-72e5-4ec1-a226-6b68dbf2c1b4.htm">updateSQLXML</a> de la classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></li><li><p>Pour stocker un objet SQLXML dans une colonne de table de base de données de type <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span>, utilisez les méthodes <b>setSQLXML</b> de la classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> ou de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>.</p></li></ul><p>L'exemple de code dans <a href="8f2ff25b-71fd-46d7-b6de-d656095d2aad.htm">Exemple de type de données SQLXML</a> montre comment effectuer ces tâches d'API usuelles. </p></div><h1 class="heading">Objets SQLXML accessibles en lecture et en écriture</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Le tableau suivant répertorie les types d'objets SQLXML pris en charge par les méthodes setter, getter et updater fournies par l'API JDBC. Les colonnes du tableau font référence aux éléments suivants : </p><ul><li><p>La colonne <b>Nom de la méthode</b> liste les méthodes getter, setter et updater prises en charge dans l'API JDBC.</p></li><li><p>La colonne <b>Objet SQLXML getter</b> représente un objet SQLXML créé par la méthode <a href="8bcf9eda-b36c-480c-8bf2-91c392d5a0ee.htm">getSQLXML</a> de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> ou par la méthode <a href="a07e0f30-cbc6-4ad7-b931-c30cad382e64.htm">getSQLXML</a> de la classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></li><li><p>La colonne <b>Objet SQLXML setter</b> représente un objet SQLXML créé par la méthode <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> de la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Notez que les méthodes setter ci-dessous acceptent uniquement l'objet SQLXML créé par la méthode <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a>.</p></li></ul><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom de la méthode </p></th><th><p>Objet SQLXML getter</p><p>(Accessible en lecture)</p></th><th><p>Objet SQLXML setter</p><p>(Accessible en écriture)</p></th></tr><tr><td><p><b>CallableStatement.setSQLXML()</b></p></td><td><p>Non pris en charge</p></td><td><p>Pris en charge</p></td></tr><tr><td><p><b>CallableStatement.setObject()</b></p></td><td><p>Non pris en charge</p></td><td><p>Pris en charge</p></td></tr><tr><td><p><b>PreparedStatement.setSQLXML()</b></p></td><td><p>Non pris en charge</p></td><td><p>Pris en charge</p></td></tr><tr><td><p><b>PreparedStatement.setObject()</b></p></td><td><p>Non pris en charge</p></td><td><p>Pris en charge</p></td></tr><tr><td><p><b>ResultSet.updateSQLXML()</b></p></td><td><p>Non pris en charge</p></td><td><p>Pris en charge</p></td></tr><tr><td><p><b>ResultSet.updateObject()</b></p></td><td><p>Non pris en charge</p></td><td><p>Pris en charge</p></td></tr><tr><td><p><b>ResultSet.getSQLXML()</b></p></td><td><p>Pris en charge</p></td><td><p>Non pris en charge</p></td></tr><tr><td><p><b>CallableStatement.getSQLXML()</b></p></td><td><p>Pris en charge</p></td><td><p>Non pris en charge</p></td></tr></table></div><p>Comme indiqué dans le tableau ci-dessus, les méthodes SQLXML setter ne fonctionnent pas avec les objets SQLXML accessibles en lecture ; de même, les méthodes getter ne fonctionnent pas avec les objets SQLXML accessibles en écriture.</p><p>Si l'application appelle la méthode <b>setObject</b> en spécifiant un paramètre d'échelle ou de longueur avec un objet SQLXML, le paramètre d'échelle ou de longueur est ignoré.</p></div><h1 class="heading">Recommandations et limitations relatives à l'utilisation des objets SQLXML</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Les applications peuvent utiliser des objets SQLXML pour lire et écrire les données XML dans la base de données. La liste suivante fournit des informations sur les limitations et recommandations spécifiques à l'utilisation d'objets SQLXML : </p><ul><li><p>Un objet SQLXML ne peut être valide que pendant la durée de la transaction au cours de laquelle il a été créé.</p></li><li><p>Un objet SQLXML reçu à partir d'une méthode getter ne peut être utilisé que pour lire des données. </p></li><li><p>Un objet SQLXML créé par l'objet de connexion ne peut être utilisé que pour écrire des données.</p></li><li><p>L'application ne peut appeler qu'une seule méthode getter sur un objet SQLXML accessible en lecture pour lire des données. Une fois la méthode getter appelée, toutes les autres méthodes getter ou setter sur le même objet SQLXML échouent. </p></li><li><p>L'application ne peut appeler que la méthode <b>free</b> sur l'objet SQLXML, une fois qu'un accès en lecture ou en écriture a eu lieu sur ce dernier. Toutefois, il est toujours possible de traiter la source ou le flux retourné tant que la colonne ou le paramètre sous-jacent est actif. Si la colonne ou le paramètre sous-jacent devient inactif, la source ou le flux associé à l'objet SQLXML est fermé. Si la colonne ou le paramètre sous-jacent n'est plus valide, les données sous-jacentes ne sont pas disponibles pour les méthodes getter du flux, de SAX (Simple API for XML) et de StAX (Streaming API for XML).</p></li><li><p>L'application ne peut appeler qu'une seule méthode setter sur un objet SQLXML accessible en écriture. Une fois la méthode setter appelée, toutes les autres méthodes setter ou getter sur le même objet SQLXML échouent.</p></li><li><p>Pour définir des données sur l'objet SQLXML, l'application doit utiliser la méthode setter appropriée ainsi que les fonctions correspondantes dans l'objet retourné.</p></li><li><p>Les méthodes <b>getSQLXML</b> de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> et de la classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> retournent des données <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> si la colonne sous-jacente est <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li><li><p>Les objets setter peuvent être valides via la connexion dans laquelle ils ont été créés.</p></li><li><p>Les applications ne sont pas autorisées à définir une valeur <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> à l'aide des méthodes setter fournies par l'interface SQLXML. Les applications peuvent définir une chaîne vide ("") à l'aide des méthodes setter fournies dans l'interface SQLXML. Pour définir une valeur <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>, les applications doivent appeler au choix :</p><ul><li><p>les méthodes <b>setNull</b> de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> et de la classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> ;</p></li><li><p>les méthodes <b>setObject</b> de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> et de la classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> ; </p></li><li><p>les méthodes <b>setSQLXML</b> de la classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> et de la classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> avec une valeur de paramètre <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li></ul></li><li><p>Lors de l'utilisation de documents XML, il est recommandé de privilégier les analyseurs SAX (Simple API for XML) et StAX (Streaming API for XML) aux analyseurs DOM (Document Object Model) pour des raisons de performances.</p></li></ul><p>Les analyseurs XML ne peuvent pas gérer les valeurs vides. Toutefois, SQL Server permet aux applications de récupérer et de stocker des valeurs vides dans les colonnes de base de données de type de données XML. En d'autres termes, lors de l'analyse des données XML, si la valeur sous-jacente est vide, une exception est levée par l'analyseur. Pour les sorties DOM, le pilote JDBC intercepte cette exception et génère une erreur. Pour les sorties SAX et Stax, l'erreur provient directement de l'analyseur.</p></div><h1 class="heading">Prise en charge de la mise en mémoire tampon adaptative et de SQLXML</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Les flux de données aux formats binaire et caractère retournés par l'objet SQLXML obéissent aux modes de mise en mémoire tampon adaptative ou de mise en mémoire tampon complète. Par ailleurs, si les analyseurs XML ne sont pas des flux, ils n'obéissent pas aux paramètres de mise en mémoire tampon adaptative ou de mise en mémoire tampon complète. Pour plus d'informations sur la mise en mémoire tampon adaptative, consultez <span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">Utilisation de la mise en mémoire tampon adaptative</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="32b7217e-1f0c-473d-9a45-176daa81584e.htm">Prise en charge des données XML</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>