<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Utilisation du pilote JDBC</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="vue d'ensemble du pilote JDBC, utilisation du pilote JDBC" /><meta name="Microsoft.Help.Id" content="6faaf05b-8b70-4ed2-9b44-eee5897f1cd0" /><meta name="Description" content="Cette section fournit des instructions de démarrage rapide pour la création d'une connexion simple à une base de données SQL Server à l'aide du Pilote JDBC Microsoft pour SQL Server." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Utilisation du pilote JDBC</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Cette section fournit des instructions de démarrage rapide pour la création d'une connexion simple à une base de données SQL Server à l'aide du Pilote JDBC Microsoft pour SQL Server. Avant de vous connecter à une base de données SQL Server, il convient d'installer SQL Server sur votre ordinateur local ou un serveur ; par ailleurs, le pilote JDBC doit également être installé sur votre ordinateur local. </p></div><h1 class="heading">Choix du fichier JAR approprié</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Le Pilote JDBC Microsoft pour SQL Server fournit les fichiers bibliothèques de classes <span sdata="langKeyword" value="sqljdbc.jar"><span class="keyword">sqljdbc.jar</span></span> et <span sdata="langKeyword" value="sqljdbc4.jar"><span class="keyword">sqljdbc4.jar</span></span> à utiliser en fonction de vos paramètres JRE (Java Runtime Environment) par défaut. Pour plus d'informations sur le fichier JAR à choisir, consultez <span sdata="link"><a href="447792bb-f39b-49b4-9fd0-1ef4154c74ab.htm">Configuration requise pour le pilote JDBC</a></span>.</p></div><h1 class="heading">Définition de Classpath</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Le pilote JDBC ne fait pas partie du Kit de développement logiciel (SDK) Java. Si vous voulez l'utiliser, vous devez définir l'instruction classpath afin d'inclure le fichier sqljdbc.jar ou sqljdbc4.jar. Si l'instruction classpath n'a pas d'entrée pour sqljdbc.jar ou sqljdbc4.jar, votre application lève l'exception usuelle « Classe introuvable ».</p><p>Les fichiers sqljdbc.jar et sqljdbc4.jar sont installés à l'emplacement suivant :</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc.jar</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc4.jar</p><p>Voici un exemple de l'instruction CLASSPATH utilisée pour une application Windows :</p><p><span class="code">CLASSPATH =.;C:\Program Files\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_4.0\enu\sqljdbc.jar</span></p><p>Voici un exemple de l'instruction CLASSPATH utilisée pour une application Unix/Linux :</p><p><span class="code">CLASSPATH =.:/home/usr1/mssqlserverjdbc/Driver/sqljdbc_4.0/enu/sqljdbc.jar</span></p><p>Vous devez vous assurer que l'instruction CLASSPATH contienne uniquement un Pilote JDBC Microsoft pour SQL Server, tel que sqljdbc.jar ou sqljdbc4.jar.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Sous Windows, les noms de répertoires d'une longueur supérieure à 8,3 ou les noms de dossiers contenant des espaces peuvent générer des problèmes avec les instructions classpath. Si vous pensez être confronté à ce type de problème, vous devez placer temporairement le fichier sqljdbc.jar ou sqljdbc4.jar dans un répertoire portant un nom simple, tel que <span class="code"> C:\Temp</span>, modifier l'instruction classpath, puis vérifier si le problème est résolu.</p></div><h1 class="heading">Applications exécutées directement à l'invite de commandes</h1><div class="subsection"><p>L'instruction classpath est configurée dans le système d'exploitation. Ajoutez sqljdbc.jar ou sqljdbc4.jar à l'instruction classpath du système. Vous pouvez également spécifier l'instruction classpath dans la ligne de commande Java qui exécute l'application à l'aide de l'option <span class="code"> java -classpath </span>.</p></div><h1 class="heading">Applications qui s'exécutent dans un IDE</h1><div class="subsection"><p>Chaque fournisseur d'IDE fournit une méthode différente pour définir l'instruction classpath dans son IDE. La seule définition de l'instruction classpath dans le système d'exploitation ne fonctionne pas. Vous devez ajouter sqljdbc.jar ou sqljdbc4.jar à l'instruction classpath de l'IDE.</p></div><h1 class="heading">Servlets et JSP</h1><div class="subsection"><p>Les servlets et les JSP sont exécutés dans un moteur de servlet/JSP tel que Tomcat. L'instruction classpath doit être définie conformément aux spécifications de la documentation relative au moteur de servlet/JSP. La seule définition de l'instruction classpath dans le système d'exploitation ne fonctionne pas. Certains moteurs de servlet/JSP affichent des écrans de configuration permettant de définir l'instruction classpath du moteur. Dans ce cas, vous devez ajouter le fichier JAR du pilote JDBC approprié à l'instruction classpath existante du moteur, puis redémarrer le moteur. Dans d'autres cas, vous pouvez déployer le pilote en copiant sqljdbc.jar ou sqljdbc4.jar dans un répertoire spécifique, tel que lib, pendant l'installation du moteur. Vous pouvez également spécifier l'instruction classpath du pilote de moteur dans un fichier de configuration spécifique au moteur.</p></div><h1 class="heading">EJB (Enterprise Java Beans)</h1><div class="subsection"><p>Les EJB (Enterprise Java Beans) sont exécutés dans un conteneur EJB. Les conteneurs EJB proviennent de différents fournisseurs. Les applets Java s'exécutent dans un navigateur mais sont téléchargés à partir d'un serveur Web. Copiez sqljdbc.jar ou sqljdbc4.jar à la racine du serveur Web et spécifiez le nom du fichier JAR sous l'onglet d'archive HTML de l'applet, par exemple <span class="code">&lt;applet ... archive=sqljdbc.jar&gt;</span>.</p></div></div><h1 class="heading">Création d'une connexion simple à une base de données</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>À l'aide de la bibliothèque de classes sqljdbc.jar, les applications doivent d'abord inscrire le pilote comme suit :</p><p><span class="code">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</span></p><p>Une fois le pilote chargé, vous pouvez établir une connexion à l'aide d'une URL de connexion et de la méthode <b>getConnection</b> de la classe <b>DriverManager</b> :</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = "jdbc:sqlserver://localhost:1433;" +
   "databaseName=AdventureWorks;user=MyUserName;password=*****;";
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>Dans l'API JDBC 4.0, la méthode <b>DriverManager.getConnection</b> est améliorée pour charger automatiquement les pilotes JDBC. Par conséquent, les applications n'ont pas besoin d'appeler la méthode <b>Class.forName</b> pour inscrire ou charger le pilote lors de l'utilisation de la bibliothèque de classes sqljdbc4.jar.</p><p>Lorsque la méthode <b>getConnection</b> de la classe <b>DriverManager</b> est appelée, un pilote approprié est localisé parmi l'ensemble des pilotes JDBC inscrits. Le fichier sqljdbc4.jar comprend le fichier « META-INF/services/java.sql.Driver », qui contient <span sdata="langKeyword" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"><span class="keyword">com.microsoft.sqlserver.jdbc.SQLServerDriver</span></span> en tant que pilote inscrit. Les applications existantes, qui chargent actuellement les pilotes à l'aide de la méthode <b>Class.forName</b>, continueront de fonctionner sans modification.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>La bibliothèque de classes sqljdbc4.jar requiert la version 6.0 de l'environnement d'exécution Java (JRE, Java Runtime Environment) ou une version ultérieure.</p></div><p>Pour plus d'informations sur la connexion à des sources de données et sur l'utilisation d'une URL de connexion, consultez <span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Création de l'URL de connexion</a></span> et <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Définition des propriétés de connexion</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">Présentation du pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>