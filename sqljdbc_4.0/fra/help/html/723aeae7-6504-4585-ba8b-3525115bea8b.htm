<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Suivi du fonctionnement du pilote</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="suivi" /><meta name="Microsoft.Help.Id" content="723aeae7-6504-4585-ba8b-3525115bea8b" /><meta name="Description" content="Le Pilote JDBC Microsoft pour SQL Server prend en charge le suivi (ou la journalisation) pour aider à résoudre les problèmes d'utilisation du pilote JDBC dans votre application." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Suivi du fonctionnement du pilote</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Le Pilote JDBC Microsoft pour SQL Server prend en charge le suivi (ou la journalisation) pour aider à résoudre les problèmes d'utilisation du pilote JDBC dans votre application. Pour permettre l'utilisation du suivi, le pilote JDBC utilise les API de journalisation de java.util.logging, qui offrent un ensemble de classes pour la création d'objets <b>Logger</b> et <b>LogRecord</b>.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Pour le composant natif (sqljdbc_xa.dll) fourni avec le pilote JDBC, le suivi est activé par le système de diagnostic intégré BID (Built-In Diagnostics). Pour obtenir des informations sur le système de diagnostic intégré BID, consultez <a href="http://go.microsoft.com/fwlink/?LinkId=70042">Suivi d'accès aux données dans SQL Server</a>.</p></div><p>Lors du développement de votre application, vous pouvez appeler des objets <b>Logger</b>, qui créent des objets <b>LogRecord</b>, lesquels sont ensuite transmis à des objets <b>Handler</b> pour être traités. Les objets <b>Logger</b> et <b>Handler</b> utilisent tous deux des niveaux de journalisation et, éventuellement, des filtres de journalisation, pour réguler les <b>LogRecords</b> qui doivent être traités. Une fois les opérations de journalisation terminées, les objets <b>Handler</b> peuvent éventuellement utiliser des objets <b>Formatter</b> pour publier les informations du journal.</p><p>Par défaut, le système java.util.logging écrit sa sortie dans un fichier. Ce fichier journal de sortie doit disposer des autorisations d'écriture dans le contexte dans lequel le pilote JDBC s'exécute.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Pour plus d'informations sur l'utilisation des divers objets de journalisation en relation avec le suivi de programme, consultez la documentation (en anglais) Java Logging APIs sur le site Web de Sun Microsystems.</p></div><p>Les sections suivantes décrivent les niveaux de journalisation et les catégories qui peuvent être journalisées et fournissent des informations sur la procédure d'activation du suivi dans votre application.</p></div><h1 class="heading">Niveaux de journalisation</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Chaque message de journal créé est associé à un niveau de journalisation. Le niveau de journalisation détermine l'importance du message de journal ; il est défini par la classe <span class="label">Level</span> dans java.util.logging. L'activation de la journalisation à un niveau active également la journalisation à tous les niveaux supérieurs. Cette section décrit les niveaux de journalisation à la fois pour les catégories de journalisation publiques et internes. Pour plus d'informations sur les catégories de journalisation, consultez la section Catégories de journalisation dans cette rubrique.</p><p>Le tableau suivant décrit chacun des niveaux de journalisation disponibles pour les catégories de journalisation publiques.</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom</p></th><th><p>Description</p></th></tr><tr><td><p>SEVERE</p></td><td><p>Indique un échec grave ; il s'agit du niveau de journalisation le plus élevé. Dans le pilote JDBC, ce niveau permet de signaler des erreurs et des exceptions.</p></td></tr><tr><td><p>WARNING</p></td><td><p>Indique un problème potentiel.</p></td></tr><tr><td><p>INFO</p></td><td><p>Fournit des messages d'information.</p></td></tr><tr><td><p>CONFIG</p></td><td><p>Fournit des messages de configuration. Notez que le pilote JDBC ne fournit actuellement aucun message de configuration.</p></td></tr><tr><td><p>FINE</p></td><td><p>Fournit des informations de suivi de base, y compris toutes les exceptions levées par les méthodes publiques.</p></td></tr><tr><td><p>FINER</p></td><td><p>Fournit des informations de suivi détaillées, y compris tous les points d'entrée et de sortie des méthodes publiques avec les types de données associés pour les paramètres et toutes les propriétés publiques pour les classes publiques. En outre, des paramètres d'entrée, des paramètres de sortie et des valeurs de retour de méthodes, à l'exception des types de valeurs de retour CLOB, BLOB, NCLOB, Reader, &lt;stream&gt;. </p></td></tr><tr><td><p>FINEST</p></td><td><p>Fournit des informations de suivi très détaillées. Il s'agit du niveau de journalisation le plus bas.</p></td></tr><tr><td><p>OFF</p></td><td><p>Désactive la journalisation.</p></td></tr><tr><td><p>ALL</p></td><td><p>Active la journalisation de tous les messages.</p></td></tr></table></div><p>Le tableau suivant décrit chacun des niveaux de journalisation disponibles pour les catégories de journalisation internes.</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom</p></th><th><p>Description</p></th></tr><tr><td><p>SEVERE</p></td><td><p>Indique un échec grave ; il s'agit du niveau de journalisation le plus élevé. Dans le pilote JDBC, ce niveau permet de signaler des erreurs et des exceptions. </p></td></tr><tr><td><p>WARNING</p></td><td><p>Indique un problème potentiel.</p></td></tr><tr><td><p>INFO</p></td><td><p>Fournit des messages d'information.</p></td></tr><tr><td><p>FINE</p></td><td><p>Fournit des informations de suivi, y compris la création et la destruction d'objets de base. En outre, toutes les exceptions levées par les méthodes publiques.</p></td></tr><tr><td><p>FINER</p></td><td><p>Fournit des informations de suivi détaillées, y compris tous les points d'entrée et de sortie des méthodes publiques avec les types de données associés pour les paramètres et toutes les propriétés publiques pour les classes publiques. En outre, des paramètres d'entrée, des paramètres de sortie et des valeurs de retour de méthodes, à l'exception des types de valeurs de retour CLOB, BLOB, NCLOB, Reader, &lt;stream&gt;.</p><p>Les catégories de journalisation suivantes existaient dans la version 1.2 du pilote JDBC avec le niveau de journalisation FINE : <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>, <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>, XA et <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>. À compter de la version 2.0, elles sont mises à niveau vers le niveau FINER.</p></td></tr><tr><td><p>FINEST</p></td><td><p>Fournit des informations de suivi très détaillées. Il s'agit du niveau de journalisation le plus bas.</p><p>Les catégories de journalisation suivantes existaient dans la version 1.2 du pilote JDBC avec le niveau de journalisation FINEST : TDS.DATA et TDS.TOKEN. À compter de la version 2.0, elles conservent le niveau de journalisation FINEST. </p></td></tr><tr><td><p>OFF</p></td><td><p>Désactive la journalisation.</p></td></tr><tr><td><p>ALL</p></td><td><p>Active la journalisation de tous les messages.</p></td></tr></table></div></div><h1 class="heading">Catégories de journalisation</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Lorsque vous créez un objet <b>Logger</b>, vous devez indiquer à l'objet l'entité ou la catégorie nommée dont vous souhaitez obtenir des informations de journal. Le pilote JDBC prend en charge les catégories de journalisation publiques suivantes, qui sont toutes définies dans le package du pilote com.microsoft.sqlserver.jdbc.</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom</p></th><th><p>Description</p></th></tr><tr><td><p>Connection</p></td><td><p>Journalise les messages dans la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Les applications peuvent affecter le niveau de journalisation FINER.</p></td></tr><tr><td><p>Statement</p></td><td><p>Journalise les messages dans la classe <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>. Les applications peuvent affecter le niveau de journalisation FINER.</p></td></tr><tr><td><p>DataSource</p></td><td><p>Journalise les messages dans la classe <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>ResultSet</p></td><td><p>Journalise les messages dans la classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>. Les applications peuvent affecter le niveau de journalisation FINER.</p></td></tr><tr><td><p>Pilote</p></td><td><p>Journalise les messages dans la classe <a href="fbdceae5-7e7b-4edb-8c33-c701ca6b2d53.htm">SQLServerDriver</a>. Les applications peuvent affecter le niveau de journalisation FINER.</p></td></tr></table></div><p>À partir de la version 2.0 du pilote JDBC Microsoft, le pilote fournit également le package com.microsoft.sqlserver.jdbc.internals, qui inclut la prise en charge de la journalisation pour les catégories de journalisation internes suivantes.</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom</p></th><th><p>Description</p></th></tr><tr><td><p>AuthenticationJNI</p></td><td><p>Messages des journaux concernant les problèmes liés à l'authentification intégrée Windows (lorsque la propriété de connexion <span sdata="langKeyword" value="authenticationScheme"><span class="keyword">authenticationScheme</span></span> est implicitement ou explicitement définie sur <span sdata="langKeyword" value="NativeAuthentication"><span class="keyword">NativeAuthentication</span></span>).</p><p>Les applications peuvent affecter le niveau de journalisation FINEST et FINE.</p></td></tr><tr><td><p>SQLServerConnection</p></td><td><p>Journalise les messages dans la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Les applications peuvent affecter le niveau de journalisation FINE et FINER.</p></td></tr><tr><td><p>SQLServerDataSource</p></td><td><p>Journalise les messages dans les classes <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>, <a href="b00e5a90-2af7-4d04-8ef8-256183777dcf.htm">SQLServerConnectionPoolDataSource</a> et <a href="4c87e9d3-904a-4b86-90cc-3684034c86ee.htm">SQLServerPooledConnection</a>.</p><p>Les applications peuvent affecter le niveau de journalisation FINER.</p></td></tr><tr><td><p>InputStream</p></td><td><p>Journalise les messages concernant les types de données suivants : java.io.InputStream, java.io.Reader et ceux qui ont un spécificateur max, tel que varchar, nvarchar ainsi que les types de données varbinary.</p><p>Les applications peuvent affecter le niveau de journalisation FINER.</p></td></tr><tr><td><p>SQLServerException</p></td><td><p>Journalise les messages dans la classe <a href="af5ef257-7cf6-4db3-b1ee-07d22d82bef1.htm">SQLServerException</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerResultSet</p></td><td><p>Journalise les messages dans la classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>. Les applications peuvent affecter le niveau de journalisation FINE, FINER et FINEST.</p></td></tr><tr><td><p>SQLServerStatement</p></td><td><p>Journalise les messages dans la classe <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>. Les applications peuvent affecter le niveau de journalisation FINE, FINER et FINEST.</p></td></tr><tr><td><p>XA  </p></td><td><p>Journalise les messages relatifs à toutes les transactions XA dans la classe <a href="95fc7b07-2498-4a7e-8f7f-ee0d86b598b4.htm">SQLServerXADataSource</a>. Les applications peuvent affecter le niveau de journalisation FINE et FINER.</p></td></tr><tr><td><p>KerbAuthentication</p></td><td><p>Messages des journaux concernant l'authentification Kerberos de type 4 (lorsque la propriété de connexion <span sdata="langKeyword" value="authenticationScheme"><span class="keyword">authenticationScheme</span></span> est implicitement ou explicitement définie sur <span sdata="langKeyword" value="JavaKerberos"><span class="keyword">JavaKerberos</span></span>). L'application peut définir le niveau de journalisation sur FINE ou FINER.</p></td></tr><tr><td><p>TDS.DATA</p></td><td><p>Journalise les messages contenant la conversation au niveau du protocole TDS entre le pilote et SQL Server. Le contenu détaillé de chaque paquet TDS envoyé et reçu est journalisé au format ASCII et hexadécimal. Les informations d'identification de connexion (noms d'utilisateurs et mots de passe) ne sont pas journalisés. Toutes les autres données sont journalisées.</p><p>Cette catégorie génère des messages clairs et très détaillés et ne peut être activée que lorsque le niveau de journalisation est défini sur FINEST.</p></td></tr><tr><td><p>TDS.Channel</p></td><td><p>Cette catégorie effectue le suivi des actions du canal de communication TCP avec SQL Server. Les messages journalisés incluent l'ouverture et la fermeture de sockets ainsi que les lectures et écritures. Elle effectue également le suivi des messages relatifs à l'établissement d'une connexion SSL (Secure Sockets Layer) à SQL Server.</p><p>Cette catégorie peut uniquement être activée en affectant le niveau de journalisation FINE, FINER ou FINEST.</p></td></tr><tr><td><p>TDS.Writer</p></td><td><p>Cette catégorie effectue le suivi des écritures dans le canal TDS. Notez que seule la longueur des écritures fait l'objet d'un suivi, et non le contenu. Cette catégorie effectue également le suivi des problèmes lorsqu'un signal d'avertissement est envoyé au serveur pour annuler l'exécution d'une instruction.</p><p>Cette catégorie peut uniquement être activée en affectant le niveau de journalisation FINEST.</p></td></tr><tr><td><p>TDS.Reader</p></td><td><p>Cette catégorie effectue le suivi de certaines opérations de lecture à partir du canal TDS au niveau FINEST. Au niveau FINEST, le suivi peut être assez détaillé. Aux niveaux WARNING et SEVERE, cette catégorie effectue le suivi lorsque le pilote reçoit un protocole TDS non valide de SQL Server avant qu'il ne ferme la connexion.</p><p>Cette catégorie peut uniquement être activée en affectant le niveau de journalisation FINER et FINEST.</p></td></tr><tr><td><p>TDS.Command</p></td><td><p>Cette catégorie effectue le suivi des transitions d'état de bas niveau et d'autres informations associées à l'exécution de commandes TDS, telles que les exécutions d'instructions Transact-SQL, les extractions de curseurs ResultSet, les validations, etc.</p><p>Cette catégorie peut uniquement être activée en affectant le niveau de journalisation FINEST.</p></td></tr><tr><td><p>TDS.TOKEN</p></td><td><p>Cette catégorie ne journalise que les jetons des paquets TDS et est moins claire que la catégorie TDS.DATA. Elle peut uniquement être activée en affectant le niveau de journalisation FINEST.</p><p>Au niveau FINEST, cette catégorie effectue le suivi des jetons TDS lors de leur traitement dans la réponse. Au niveau SEVERE, cette catégorie effectue le suivi en cas de jeton TDS non valide.</p></td></tr><tr><td><p>SQLServerDatabaseMetaData</p></td><td><p>Journalise les messages dans la classe <a href="8b8049d0-8c6d-4476-866b-098709f37eec.htm">SQLServerDatabaseMetaData</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerResultSetMetaData</p></td><td><p>Journalise les messages dans la classe <a href="9a36885f-83f3-44af-85f0-2b849dfd20d4.htm">SQLServerResultSetMetaData</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerParameterMetaData</p></td><td><p>Journalise les messages dans la classe <a href="546290e0-9411-4a2b-aa36-61251e70e9cf.htm">SQLServerParameterMetaData</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerBlob</p></td><td><p>Journalise les messages dans la classe <a href="88bd8623-889d-4b5d-99ff-c85b32f3ff5c.htm">SQLServerBlob</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerClob</p></td><td><p>Journalise les messages dans la classe <a href="24170524-e1ab-4e80-8fd1-6688efacfbde.htm">SQLServerClob</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerSQLXML</p></td><td><p>Journalise les messages dans la classe <b>SQLServerSQLXML</b> interne. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerDriver</p></td><td><p>Journalise les messages dans la classe <a href="fbdceae5-7e7b-4edb-8c33-c701ca6b2d53.htm">SQLServerDriver</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr><tr><td><p>SQLServerNClob</p></td><td><p>Journalise les messages dans la classe <a href="3d3883a2-c39c-439f-bbc0-01e73968672b.htm">SQLServerNClob</a>. Les applications peuvent affecter le niveau de journalisation FINE.</p></td></tr></table></div></div><h1 class="heading">Activation du suivi par programme</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Vous pouvez activer le suivi par programme en créant un objet <b>Logger</b> et en indiquant la catégorie à journaliser. Par exemple, le code suivant montre comment activer la journalisation pour les instructions SQL :</p><div class="sampleCode"><span codeLanguage="other"><pre>Logger logger = Logger.getLogger("com.microsoft.sqlserver.jdbc.Statement");
logger.setLevel(Level.FINER);</pre></span></div><p>Pour désactiver la journalisation dans le code, utilisez ce qui suit :</p><div class="sampleCode"><span codeLanguage="other"><pre>logger.setLevel(Level.OFF);</pre></span></div><p>Pour journaliser toutes les catégories disponibles, utilisez ce qui suit :</p><div class="sampleCode"><span codeLanguage="other"><pre>Logger logger = Logger.getLogger("com.microsoft.sqlserver.jdbc");
logger.setLevel(Level.FINE);</pre></span></div><p>Pour désactiver la journalisation d'une catégorie spécifique, utilisez ce qui suit :</p><div class="sampleCode"><span codeLanguage="other"><pre>Logger logger = Logger.getLogger("com.microsoft.sqlserver.jdbc.Statement");
logger.setLevel(Level.OFF);</pre></span></div></div><h1 class="heading">Activation du suivi à l'aide du fichier Logging.Properties</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Vous pouvez également activer le suivi à l'aide du fichier <span class="code"> logging.properties </span> qui se trouve dans le répertoire <span class="code"> lib </span> d'installation de Java Runtime Environment (JRE). Ce fichier permet de définir les valeurs par défaut des fonctionnalités de journalisation et de gestion utilisées lorsque le suivi est activé.</p><p>L'exemple suivant présente les paramètres pouvant être définis dans les fichiers <span class="code">logging.properties</span> :</p><div class="sampleCode"><span codeLanguage="other"><pre># Specify the handler, the handlers will be installed during VM startup.
handlers= java.util.logging.FileHandler
 
# Default global logging level.
.level= OFF

# default file output is in user's home directory.
java.util.logging.FileHandler.pattern = %h/java%u.log
java.util.logging.FileHandler.limit = 5000000
java.util.logging.FileHandler.count = 20
java.util.logging.FileHandler.formatter = java.util.logging.SimpleFormatter
java.util.logging.FileHandler.level = FINEST

# Facility specific properties.
com.microsoft.sqlserver.jdbc.level=FINEST
</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Vous pouvez définir les propriétés dans le fichier <span class="code"> logging.properties </span> à l'aide de l'objet <b>LogManager</b> figurant dans java.util.logging.</p></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="723e2680-a0c5-4a7d-a319-1e49e41078cf.htm">Diagnostic de problèmes avec le pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>