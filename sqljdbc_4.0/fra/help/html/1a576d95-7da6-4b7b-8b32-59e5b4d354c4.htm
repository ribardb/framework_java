<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Exécution d'opérations par lot</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="opérations par lot" /><meta name="Microsoft.Help.Id" content="1a576d95-7da6-4b7b-8b32-59e5b4d354c4" /><meta name="Description" content="Pour améliorer les performances lors de l'exécution de mises à jour multiples d'une base de données SQL Server, le Pilote JDBC Microsoft pour SQL Server permet d'effectuer plusieurs mises à jour sous forme d'une seule unité de travail, appelée également lo" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Exécution d'opérations par lot</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Pour améliorer les performances lors de l'exécution de mises à jour multiples d'une base de données SQL Server, le Pilote JDBC Microsoft pour SQL Server permet d'effectuer plusieurs mises à jour sous forme d'une seule unité de travail, appelée également lot. </p><p>Les classes <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>, <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> et <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> peuvent toutes être utilisées pour soumettre des mises à jour par lot. La méthode <a href="134f1455-c98c-4112-ab2d-9205a0db73df.htm">addBatch</a> permet d'ajouter une commande. La méthode <a href="6e5cda26-e24d-4637-8dfd-8135ba126e3b.htm">clearBatch</a> permet d'effacer la liste des commandes. La méthode <a href="fb034f63-2532-4da8-a1b0-bc125734585a.htm">executeBatch</a> permet de soumettre toutes les commandes pour traitement. Seules des instructions DDL (Data Definition Language, langage de définition de données) et DML (Data Manipulation Language, langage de manipulation de données) qui retournent un seul nombre de mises à jour peuvent être exécutées dans un lot. </p><p>La méthode <b>executeBatch</b> retourne un tableau de valeurs <span sdata="langKeyword" value="int"><span class="keyword">int</span></span> correspondant au nombre de mises à jour de chaque commande. En cas d'échec de l'une des commandes, une <b>BatchUpdateException</b> est générée et vous devez utiliser la méthode <b>getUpdateCounts</b> de la classe <b>BatchUpdateException</b> pour extraire le tableau de nombres de mises à jour. En cas d'échec d'une commande, le pilote continue à traiter les commandes restantes. Toutefois, si une commande contient une erreur de syntaxe, les instructions contenues dans le lot échouent.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Si vous ne devez pas utiliser un certain nombre de mises à jour, vous pouvez d'abord émettre une instruction SET NOCOUNT ON vers SQL Server. Ceci réduira le trafic réseau et améliorera les performances de votre application.</p></div><p>Par exemple, créez la table suivante dans l'exemple de base de données SQL Server 2005 AdventureWorks :</p><div class="sampleCode"><span codeLanguage="other"><pre>CREATE TABLE TestTable 
   (Col1 int IDENTITY, 
    Col2 varchar(50), 
    Col3 int);</pre></span></div><p>Dans l'exemple suivant, une connexion ouverte à l'exemple de base de données AdventureWorks est transmise à la fonction, la méthode <b>addBatch</b> est utilisée pour créer les instructions à exécuter et la méthode <b>executeBatch</b> est appelée pour soumettre le lot à la base de données.</p><div class="sampleCode"><span codeLanguage="other"><pre>public static void executeBatchUpdate(Connection con) {
   try {
      Statement stmt = con.createStatement();
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('X', 100)");
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('Y', 200)");
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('Z', 300)");
      int[] updateCounts = stmt.executeBatch();
      stmt.close();
   }
   catch (Exception e) {
      e.printStackTrace();
   }
}</pre></span></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Utilisation d'instructions avec le pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>