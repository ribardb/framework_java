<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Méthode getProcedureColumns (SQLServerDatabaseMetaData)</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="méthode SQLServerDatabaseMetaData.getProcedureColumns" /><meta name="Microsoft.Help.Id" content="4f0df8fe-3cd6-46e4-ae3c-dc23c35676b2" /><meta name="Description" content="Récupère une description des paramètres de procédure stockée et les colonnes de résultats." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Méthode getProcedureColumns (SQLServerDatabaseMetaData)</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Récupère une description des paramètres de procédure stockée et les colonnes de résultats.</p></div><h1 class="heading">Syntaxe</h1><div id="syntaxSection" class="section"><div class="sampleCode"><span codeLanguage="other"><pre>
public java.sql.ResultSet <b>getProcedureColumns</b>(java.lang.String <span class="parameter" sdata="paramReference">sCatalog</span>,
                                              java.lang.String <span class="parameter" sdata="paramReference">sSchema</span>,
                                              java.lang.String <span class="parameter" sdata="paramReference">proc</span>,
                                              java.lang.String <span class="parameter" sdata="paramReference">col</span>)</pre></span></div></div><h1 class="heading">Paramètres</h1><div id="parametersSection" class="section" name="collapseableSection" style=""><p><span class="parameter" sdata="paramReference">sCatalog</span></p><p><span sdata="langKeyword" value=" String "><span class="keyword"> String </span></span>qui contient le nom du catalogue. La spécification d'une valeur Null pour ce paramètre indique que le nom du catalogue n'a pas besoin d'être utilisé.</p><p><span class="parameter" sdata="paramReference">sSchema</span></p><p><span sdata="langKeyword" value=" String "><span class="keyword"> String </span></span>qui contient le modèle de nom du schéma. La spécification d'une valeur Null pour ce paramètre indique que le nom du schéma n'a pas besoin d'être utilisé.</p><p><span class="parameter" sdata="paramReference">proc</span></p><p><span sdata="langKeyword" value=" String "><span class="keyword"> String </span></span>qui contient le modèle de nom de la procédure.</p><p><span class="parameter" sdata="paramReference">col</span></p><p><span sdata="langKeyword" value=" String "><span class="keyword"> String </span></span>qui contient le modèle de nom de la colonne. La spécification d'une valeur Null pour ce paramètre retourne une ligne pour chaque colonne.</p></div><h1 class="heading">Valeur de retour</h1><div id="returnValueSection" class="section" name="collapseableSection" style=""><p>Objet <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></div><h1 class="heading">Exceptions</h1><div id="ddueExceptionsSection" class="section" name="collapseableSection" style=""><p><a href="af5ef257-7cf6-4db3-b1ee-07d22d82bef1.htm">SQLServerException</a></p></div><h1 class="heading">Notes</h1><div id="languageReferenceRemarksSection" class="section" name="collapseableSection" style=""><p>Cette méthode <b>getProcedureColumns</b> est spécifiée par la méthode <b>getProcedureColumns</b> dans l'interface java.sql.DatabaseMetaData.</p><p>Le jeu de résultats retourné par la méthode <b>getProcedureColumns</b> contiendra les informations suivantes :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nom</p></th><th><p>Type</p></th><th><p>Description</p></th></tr><tr><td><p>PROCEDURE_CAT</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom de la base de données qui contient la procédure stockée spécifiée.</p></td></tr><tr><td><p>PROCEDURE_SCHEM</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Schéma pour la procédure stockée.</p></td></tr><tr><td><p>PROCEDURE_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom de la procédure stockée.</p></td></tr><tr><td><p>COLUMN_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom de la colonne.</p></td></tr><tr><td><p>COLUMN_TYPE</p></td><td><p><span sdata="langKeyword" value="short"><span class="keyword">short</span></span></p></td><td><p>Type de la colonne. Les valeurs possibles sont les suivantes :</p><p>procedureColumnUnknown (0)</p><p>procedureColumnIn (1)</p><p>procedureColumnInOut (2)</p><p>procedureColumnOut (4)</p><p>procedureColumnReturn (5)</p><p>procedureColumnResult (3)</p></td></tr><tr><td><p>DATA_TYPE</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Type de données SQL de java.sql.Types.</p></td></tr><tr><td><p>TYPE_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du type de données.</p></td></tr><tr><td><p>PRECISION</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Nombre total de chiffres significatifs.</p></td></tr><tr><td><p>LENGTH</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Longueur des données en octets.</p></td></tr><tr><td><p>SCALE</p></td><td><p><span sdata="langKeyword" value="short"><span class="keyword">short</span></span></p></td><td><p>Nombre de chiffres situés à droite de la virgule décimale.</p></td></tr><tr><td><p>RADIX</p></td><td><p><span sdata="langKeyword" value="short"><span class="keyword">short</span></span></p></td><td><p>Base des types numériques.</p></td></tr><tr><td><p>NULLABLE</p></td><td><p><span sdata="langKeyword" value="short"><span class="keyword">short</span></span></p></td><td><p>Indique si la colonne peut contenir une valeur Null. Les valeurs possibles sont les suivantes :</p><p>procedureNoNulls (0)</p><p>procedureNullable (1)</p><p>procedureNullableUnknown (2)</p></td></tr><tr><td><p>REMARKS</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Description de la colonne de procédure.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL Server ne retourne pas de valeur pour cette colonne.</p></div></td></tr><tr><td><p>COLUMN_DEF</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Valeur par défaut de la colonne.</p></td></tr><tr><td><p>SQL_DATA_TYPE</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Cette colonne est la même que la colonne <span sdata="langKeyword" value="DATA_TYPE"><span class="keyword">DATA_TYPE</span></span>, excepté pour les types de données <span sdata="langKeyword" value="datetime"><span class="keyword">datetime</span></span> et <span sdata="langKeyword" value="interval"><span class="keyword">interval</span></span> ISO. </p></td></tr><tr><td><p>SQL_DATETIME_SUB</p></td><td><p><span sdata="langKeyword" value="smallint"><span class="keyword">smallint</span></span></p></td><td><p>Sous-code <span sdata="langKeyword" value="datetime"><span class="keyword">datetime</span></span><span sdata="langKeyword" value="interval"><span class="keyword">interval</span></span> ISO si la valeur de <span sdata="langKeyword" value="SQL_DATA_TYPE"><span class="keyword">SQL_DATA_TYPE</span></span> est <span sdata="langKeyword" value="SQL_DATETIME"><span class="keyword">SQL_DATETIME</span></span> ou <span sdata="langKeyword" value="SQL_INTERVAL"><span class="keyword">SQL_INTERVAL</span></span>. Pour les types de données autres que <span sdata="langKeyword" value="datetime"><span class="keyword">datetime</span></span> et <span sdata="langKeyword" value="interval"><span class="keyword">interval</span></span> ISO, cette colonne a pour valeur NULL.</p></td></tr><tr><td><p>CHAR_OCTET_LENGTH</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Nombre maximal d'octets dans la colonne.</p></td></tr><tr><td><p>ORDINAL_POSITION</p></td><td><p><span sdata="langKeyword" value="int"><span class="keyword">int</span></span></p></td><td><p>Index de la colonne dans la table.</p></td></tr><tr><td><p>IS_NULLABLE</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Indique si la colonne autorise les valeurs Null.</p></td></tr><tr><td><p>SS_TYPE_CATALOG_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du catalogue qui contient le type défini par l'utilisateur (UDT).</p></td></tr><tr><td><p>SS_TYPE_SCHEMA_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du schéma qui contient le type défini par l'utilisateur (UDT).</p></td></tr><tr><td><p>SS_UDT_CATALOG_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom complet du type défini par l'utilisateur (UDT).</p></td></tr><tr><td><p>SS_UDT_SCHEMA_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du catalogue dans lequel un nom de collection de schémas XML est défini. Si le nom du catalogue est introuvable, cette variable contient une chaîne vide.</p></td></tr><tr><td><p>SS_UDT_ASSEMBLY_TYPE_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du schéma dans lequel un nom de collection de schémas XML est défini. Si le nom du schéma est introuvable, la chaîne est vide.</p></td></tr><tr><td><p>SS_XML_SCHEMACOLLECTION_CATALOG_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom d'une collection de schémas XML. Si le nom est introuvable, la chaîne est vide.</p></td></tr><tr><td><p>SS_XML_SCHEMACOLLECTION_SCHEMA_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du catalogue qui contient le type défini par l'utilisateur (UDT).</p></td></tr><tr><td><p>SS_XML_SCHEMACOLLECTION_NAME</p></td><td><p><span sdata="langKeyword" value="String"><span class="keyword">String</span></span></p></td><td><p>Nom du schéma qui contient le type défini par l'utilisateur (UDT).</p></td></tr><tr><td><p>SS_DATA_TYPE</p></td><td><p><span sdata="langKeyword" value="tinyint"><span class="keyword">tinyint</span></span></p></td><td><p>Type de données SQL Server, utilisé par les procédures stockées étendues.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Pour plus d'informations sur les types de données retournés par cette méthode SQL Server, consultez la rubrique « Types de données (Transact-SQL) » dans la documentation en ligne de SQL Server.</p></div></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Pour plus d'informations sur les données retournées par la méthode <b>getProcedureColumns</b>, consultez la rubrique « sp_sproc_columns (Transact-SQL) » dans la documentation en ligne de SQL Server.</p></div></div><h1 class="heading">Exemple</h1><div id="exampleSection" class="section" name="collapseableSection" style=""><p>L'exemple suivant démontre comment utiliser la méthode <b>getProcedureColumns</b> pour retourner des informations sur la procédure stockée uspGetBillOfMaterials dans l'exemple de base de données SQL Server 2005AdventureWorks.</p><div class="sampleCode"><span codeLanguage="other"><pre>public static void executeGetProcedureColumns(Connection con) {
   try {
      DatabaseMetaData dbmd = con.getMetaData();
      ResultSet rs = dbmd.getProcedureColumns(null, null, "uspGetBillOfMaterials", null);
      ResultSetMetaData rsmd = rs.getMetaData();

      // Display the result set data.
      int cols = rsmd.getColumnCount();
      while(rs.next()) {
         for (int i = 1; i &lt;= cols; i++) {
            System.out.println(rs.getString(i));
         }
      }
      rs.close();
   } 

   catch (Exception e) {
      e.printStackTrace();
   }
}</pre></span></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8b8049d0-8c6d-4476-866b-098709f37eec.htm">Classe SQLServerDatabaseMetaData</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="327ba0bc-438a-494c-b119-1cd4a096bb58.htm">Membres de SQLServerDatabaseMetaData</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>