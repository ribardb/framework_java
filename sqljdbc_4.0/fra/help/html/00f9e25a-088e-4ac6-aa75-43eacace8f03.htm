<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Utilisation de séquences d'échappement SQL</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="séquences d'échappement SQL" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="Le Pilote JDBC Microsoft pour SQL Server prend en charge l'utilisation des séquences d'échappement SQL, tel que le définit l'API JDBC." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Utilisation de séquences d'échappement SQL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Le Pilote JDBC Microsoft pour SQL Server prend en charge l'utilisation des séquences d'échappement SQL, tel que le définit l'API JDBC. Les séquences d'échappement sont utilisées dans une instruction SQL pour indiquer au pilote que la partie d'échappement de la chaîne SQL doit être gérée différemment. Lorsque le pilote JDBC traite la partie d'échappement d'une chaîne SQL, il traduit cette partie de la chaîne en code SQL compris par SQL Server. </p><p>Il existe cinq types de séquences d'échappement requis par l'API JDBC, et tous sont pris en charge par le pilote JDBC :</p><ul><li><p>Littéraux génériques LIKE</p></li><li><p>Gestion de fonction</p></li><li><p>Littéraux de date et heure</p></li><li><p>Appels de procédure stockée</p></li><li><p>Jointures externes</p></li></ul><p>La syntaxe de séquence d'échappement utilisée par le pilote JDBC est la suivante :</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Le traitement d'échappement SQL est toujours activé pour le pilote JDBC.</p></div><p>Les sections suivantes décrivent les cinq types de séquences d'échappement et comment ils sont pris en charge par le pilote JDBC.</p></div><h1 class="heading">Littéraux génériques LIKE</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Le pilote JDBC prend en charge la syntaxe <span class="code">{escape 'escape character'}</span> pour l'utilisation de caractères génériques de clause LIKE comme littéraux. Par exemple, le code suivant retournera des valeurs pour col3, où la valeur de col2 commence littéralement par un trait de soulignement (et pas son utilisation générique).</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>La séquence d'échappement doit être à la fin de l'instruction SQL. Pour plusieurs instructions SQL dans une chaîne de commande, la séquence d'échappement doit être à la fin de chaque instruction SQL pertinente.</p></div></div><h1 class="heading">Gestion de fonction</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Le pilote JDBC prend en charge les séquences d'échappement de fonction dans les instructions SQL avec la syntaxe suivante :</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>où <span class="code">functionName</span> est une fonction prise en charge par le pilote JDBC. Exemple :</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>Le tableau suivant répertorie les différentes fonctions prises en charge par le pilote JDBC lors de l'utilisation d'une séquence d'échappement de fonction :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Fonctions de chaîne</p></th><th><p>Fonctions numériques</p></th><th><p>Fonctions datetime</p></th><th><p>Fonctions système</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Si vous essayez d'utiliser une fonction que la base de données ne prend pas en charge, une erreur se produit.</p></div></div><h1 class="heading">Littéraux de date et heure</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>La syntaxe d'échappement pour les littéraux de date, heure et horodatage est la suivante : </p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>où <span class="code">literal-type</span> est l'un des éléments suivants :</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Type littéral</p></th><th><p>Description</p></th><th><p>Format de la valeur</p></th></tr><tr><td><p>d</p></td><td><p>Date</p></td><td><p>aaaa-mm-jj</p></td></tr><tr><td><p>t</p></td><td><p>Heure</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>TimeStamp</p></td><td><p>aaaa-mm-jj hh:mm:ss[.f...]</p></td></tr></table></div><p>Exemple :</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">Appels de procédure stockée</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Le pilote JDBC prend en charge la syntaxe d'échappement <span class="code">{? = call proc_name(?,...)}</span> et <span class="code">{call proc_name(?,...)}</span> pour les appels de procédure stockée, selon que vous devez ou non traiter un paramètre de retour. </p><p>Une procédure est un objet exécutable stocké dans la base de données. Généralement, il s'agit d'une ou plusieurs instructions SQL qui ont été précompilées. La syntaxe de séquence d'échappement pour appeler une procédure stockée est la suivante : </p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>où <span class="code">procedure-name</span> spécifie le nom d'une procédure stockée et <span class="code">parameter</span> un paramètre de procédure stockée.</p><p>Pour plus d'informations sur l'utilisation de la syntaxe d'échappement <span class="code">call</span> avec des procédures stockées, consultez <span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Utilisation d'instructions avec des procédures stockées</a></span>.</p></div><h1 class="heading">Jointures externes</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Le pilote JDBC prend en charge la syntaxe de jointure externe SQL92 gauche, droite et entière. La séquence d'échappement pour les jointures externes est la suivante :</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>où outer-join est :</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>où <span class="code">table-reference</span> est un nom de table et <span class="code">search-condition</span> est la condition de jointure que vous souhaitez utiliser pour les tables.</p><p>Exemple :</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>Les séquences d'échappement de jointure externe suivantes sont prises en charge par le pilote JDBC :</p><ul><li><p>Jointures externes gauches</p></li><li><p>Jointures externes droites</p></li><li><p>Jointures externes entières</p></li><li><p>Jointures externes imbriquées</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Utilisation d'instructions avec le pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>