<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Travail sur une connexion</title><meta name="Language" content="fr-fr" /><meta name="System.Keywords" content="connexion" /><meta name="Microsoft.Help.Id" content="cf8ee392-8a10-40a3-ae32-31c7b1efdd04" /><meta name="Description" content="Les sections suivantes proposent des exemples des différents modes de connexion à une base de données SQL Server à l'aide de la classe SQLServerConnection du Pilote JDBC Microsoft pour SQL Server." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Travail sur une connexion</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Les sections suivantes proposent des exemples des différents modes de connexion à une base de données SQL Server à l'aide de la classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> du Pilote JDBC Microsoft pour SQL Server.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Si vous rencontrez des problèmes de connexion à SQL Server via le pilote JDBC, consultez <a href="bfba0b49-2e1f-411d-a625-d25fad9ea12d.htm">Résolution des problèmes de connectivité</a> pour obtenir des suggestions de solutions.</p></div></div><h1 class="heading">Création d'une connexion via la classe DriverManager</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>La façon la plus simple de créer une connexion à une base de données SQL Server consiste à charger le pilote JDBC et à appeler la méthode <b>getConnection</b> de la classe <b>DriverManager</b>, comme suit :</p><div class="sampleCode"><span codeLanguage="other"><pre>Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
String connectionUrl = "jdbc:sqlserver://localhost;database=AdventureWorks;integratedSecurity=true;"
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>Cette technique crée une connexion de base de données via le premier pilote disponible dans la liste des pilotes capables de se connecter avec succès à l'URL donnée.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Lors de l'utilisation de la bibliothèque de classes sqljdbc4.jar, les applications n'ont pas besoin d'inscrire ni de charger explicitement le pilote à l'aide de la méthode <b>Class.forName</b>. Lorsque la méthode <b>getConnection</b> de la classe <b>DriverManager</b> est appelée, un pilote approprié est localisé parmi l'ensemble des pilotes JDBC inscrits. Pour plus d'informations, consultez Utilisation du pilote JDBC.</p></div></div><h1 class="heading">Création d'une connexion via la classe SQLServerDriver</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Si vous devez spécifier un pilote en particulier dans la liste des pilotes pour <b>DriverManager</b>, vous pouvez créer une connexion de base de données à l'aide de la méthode <a href="43813a4c-1cc7-4659-ba27-f1786f1371eb.htm">connect</a> de la classe <a href="fbdceae5-7e7b-4edb-8c33-c701ca6b2d53.htm">SQLServerDriver</a>, comme suit :</p><div class="sampleCode"><span codeLanguage="other"><pre>Driver d = (Driver) Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();
String connectionUrl = "jdbc:sqlserver://localhost;database=AdventureWorks;integratedSecurity=true;"
Connection con = d.connect(connectionUrl, new Properties());</pre></span></div></div><h1 class="heading">Création d'une connexion via la classe SQLServerDataSource</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Si vous devez établir une connexion à l'aide de la classe <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>, vous pouvez utiliser les différentes méthodes setter de la classe avant d'appeler la méthode <a href="7f520e96-5313-468f-b987-535ddaea027e.htm">getConnection</a>, comme suit :</p><div class="sampleCode"><span codeLanguage="other"><pre>SQLServerDataSource ds = new SQLServerDataSource();
ds.setUser("MyUserName");
ds.setPassword("*****");
ds.setServerName("localhost");
ds.setPortNumber(1433); 
ds.setDatabaseName("AdventureWorks");
Connection con = ds.getConnection();</pre></span></div></div><h1 class="heading">Création d'une connexion visant une source de données très spécifique</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Si vous devez créer une connexion de base de données qui vise une source de données très spécifique, plusieurs approches s'offrent à vous. Chacune d'elles dépend des propriétés définies à l'aide de l'URL de connexion.</p><p>Pour établir une connexion à l'instance par défaut sur un serveur distant, utilisez ce qui suit :</p><p><span class="code">String url = "jdbc:sqlserver://MyServer;integratedSecurity=true;"</span></p><p>Pour établir une connexion à un port spécifique sur un serveur, utilisez ce qui suit :</p><p><span class="code">String url = "jdbc:sqlserver://MyServer:1533;integratedSecurity=true;"</span></p><p>Pour établir une connexion à une instance nommée sur un serveur, utilisez ce qui suit :</p><p><span class="code">String url = "jdbc:sqlserver://209.196.43.19;instanceName=INSTANCE1;integratedSecurity=true;"</span></p><p>Pour établir une connexion à une base de données spécifique sur un serveur, utilisez ce qui suit :</p><p><span class="code">String url = "jdbc:sqlserver://172.31.255.255;database=AdventureWorks;integratedSecurity=true;"</span></p><p>Pour plus d'exemples d'URL de connexion, consultez <span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Création de l'URL de connexion</a></span>.</p></div><h1 class="heading">Création d'une connexion avec un délai de connexion personnalisé</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Si vous devez vous adapter à la charge du serveur ou au trafic réseau, vous pouvez établir une connexion ayant une valeur de délai de connexion spécifique, exprimée en secondes, comme suit :</p><p><span class="code">String url = "jdbc:sqlserver://MyServer;loginTimeout=90;integratedSecurity=true;"</span></p></div><h1 class="heading">Création d'une connexion avec une identité au niveau de l'application</h1><div id="sectionSection5" class="section" name="collapseableSection" style=""><p>Si vous devez utiliser la journalisation et la définition de profils, vous devez identifier votre connexion comme provenant d'une application spécifique, comme suit :</p><p><span class="code">String url = "jdbc:sqlserver://MyServer;applicationName=MYAPP.EXE;integratedSecurity=true;"</span></p></div><h1 class="heading">Fermeture d'une connexion</h1><div id="sectionSection6" class="section" name="collapseableSection" style=""><p>Vous pouvez explicitement fermer une connexion de base de données en appelant la méthode <a href="f0f26585-bdf7-4737-b434-8c7e115c8e94.htm">close</a> de la classe <b>SQLServerConnection</b>, comme suit :</p><p><span class="code">con.close();</span></p><p>Cela libère les ressources de base de données utilisées par l'objet <b>SQLServerConnection</b> ou retourne la connexion au regroupement de connexions dans les scénarios regroupés.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>L'appel de la méthode <b>close</b> entraîne également l'annulation des transactions en attente.</p></div></div><span id="seeAlsoSpan"><h1 class="heading">Voir aussi</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">Connexion à SQL Server à l'aide du pilote JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envoyez vos <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dMerci pour vos commentaires qui permettent aux équipes chargées de rédiger la documentation développeur d\'en améliorer la qualité. Pendant la révision de vos commentaires, il est possible que nous vous contactions par courrier électronique afin de vous demander des éclaircissements ou d\'autres commentaires sur la solution envisagée. Nous n\'utilisons pas votre adresse de messagerie dans un autre but et nous la supprimons une fois notre révision terminée.%0\APour plus d\'informations sur les politiques de confidentialité de Microsoft, consultez http://privacy.microsoft.com/fr-fr/default.aspx.%0\A%0\d','Commentaires client.');">commentaires</a> sur cette rubrique à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Tous droits réservés.</a></p></span></div></div></body></html>